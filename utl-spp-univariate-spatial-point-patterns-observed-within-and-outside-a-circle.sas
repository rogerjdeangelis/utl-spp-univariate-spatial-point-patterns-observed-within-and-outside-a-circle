%let pgm=utl-spp-univariate-spatial-point-patterns-observed-within-and-outside-a-circle;                                                       
                                                                                                                                               
Univariate spatial point patterns observed within and outside a circle                                                                         
                                                                                                                                               
graphic output;                                                                                                                                
github                                                                                                                                         
https://tinyurl.com/stsm4mh                                                                                                                    
https://github.com/rogerjdeangelis/utl-spp-univariate-spatial-point-patterns-observed-within-and-outside-a-circle/blob/master/circle.pdf       
                                                                                                                                               
github                                                                                                                                         
https://tinyurl.com/wu4f6bk                                                                                                                    
https://github.com/rogerjdeangelis/utl-spp-univariate-spatial-point-patterns-observed-within-and-outside-a-circle                              
                                                                                                                                               
https://www.rdocumentation.org/packages/ads/versions/1.5-3/topics/spp                                                                          
                                                                                                                                               
SAS Forum                                                                                                                                      
https://tinyurl.com/rvcfm47                                                                                                                    
https://communities.sas.com/t5/Statistical-Procedures/SPP-Circular-Area/m-p/610223                                                             
                                                                                                                                               
A spatial point pattern is assumed to have been observed within a                                                                              
specific sampling window (a finite study region) defined by the                                                                                
window argument. If window is a simple "swin" object, it may be                                                                                
coerced into a complex type by adding a triangles argument (see swin).                                                                         
A spatial point pattern may be of 3 different types.                                                                                           
                                                                                                                                               
*_                   _                                                                                                                         
(_)_ __  _ __  _   _| |_                                                                                                                       
| | '_ \| '_ \| | | | __|                                                                                                                      
| | | | | |_) | |_| | |_                                                                                                                       
|_|_| |_| .__/ \__,_|\__|                                                                                                                      
        |_|                                                                                                                                    
;                                                                                                                                              
                                                                                                                                               
%let x_origin=55;                                                                                                                              
%let y_origin=45;                                                                                                                              
%let radious=50;                                                                                                                               
                                                                                                                                               
win=c(&x_origin,&y_origin,&radius));                                                                                                           
                                                                                                                                               
options validvarname=upcase;                                                                                                                   
libname sd1 "d:/sd1";                                                                                                                          
data sd1.have;                                                                                                                                 
  input x y @@;                                                                                                                                
cards4;                                                                                                                                        
14.4 17.4 17.8 7.3 17.8 15.8 9.4 8.3 5.4 2.6 14.7 0.9 5.8 18.6                                                                                 
8.2 36.5 6.6 27.5 11 29.8 14.6 30.8 17.6 36.1 19.2 23.2 5.3 48 5                                                                               
56.7 2.1 44.9 -0.5 50.2 3.3 79.1 17.2 79.6 18.2 71 13.8 65.8                                                                                   
17.5 66.1 9.4 60.6 6.6 68.2 2.6 75.8 9.8 89.4 14 80.7 25.6 19.7                                                                                
26.2 6.9 27 4.5 32.3 3.3 35.6 4 39.1 1.2 22.8 38.8 34.1 39.2 40                                                                                
39.5 36.9 31.3 22.2 29.4 25.6 58.7 20.3 59.2 27.4 52.7 21.2 49.8                                                                               
27.9 41.6 38.7 43.7 34.6 49.5 39.6 56.7 27.4 74.4 34.1 71.5 35.6                                                                               
79.7 40 70.4 34.4 63.5 38.8 60.8 25.3 62.5 30.3 82.7 24.3 84.7                                                                                 
40 83.9 33.1 82.6 36.5 91.1 33.1 92 54.1 19 51.4 14.8 41.5 17.9                                                                                
42.8 1.1 40.2 11.2 43.4 8.6 46 7.5 57.4 1.6 48.4 33.3 52.7 36.5                                                                                
58.3 33.1 42.9 24.4 47.6 47.1 48.6 40.8 45.7 41 54 44.7 51.2                                                                                   
48.9 46.3 55.1 56.8 51.1 55.9 43.3 58.7 72.4 55.6 77.8 50 66.7                                                                                 
46.5 60.4 60 67.2 47.4 81.9 51.3 86.6 48.2 90.9 60 88.1 57.2                                                                                   
85.4 67 9 75.4 6.4 76.2 9.1 71.4 17.1 69.5 15.2 61.4 39.8 75.3                                                                                 
25 63.4 22.7 66.7 21.9 67.7 32.5 78.8 36.3 68.2 38.1 66.1 55.6                                                                                 
60.9 45.4 78.5 49.8 74.4 44 78.4 42.4 74.2 43.8 68.2 48.3 73                                                                                   
75.3 73.6 60.4 70.7 70.5 72.6 68.1 64 74.5 60.4 65.9 79 75.6                                                                                   
70.1 63.7 77.2 74 98.3 18.2 95.1 16.1 80.9 13.4 83.9 3.6 88.4                                                                                  
2.9 82.7 18.1 90.9 12.7 88.8 11.5 99 24.8 99.8 35.4 82.7 22.8                                                                                  
85.8 23.7 89.1 22.1 80.4 50.6 85.2 45.6 87.8 47.5 89.6 56.8 91.9                                                                               
42.6 98.3 45 86.2 50.2 81.4 53.6 96.5 78.4 97.7 74 93.5 62 86.1                                                                                
61 81.2 62.3 84 67.3 80.9 72.7 89.9 88 94.6 92.7 95 91.8 98.6                                                                                  
84.9 106.6 17.9 109.2 14.6 107.2 25.6 100.8 53.7 104.3 45.7                                                                                    
103.2 72.1 104 91 30.6 7.9 61 77.6 62.5 86.2 80.1 33.6 104.2                                                                                   
55.2 101.7 48.8 37.3 26.8 57.3 43.5 55.8 59 50.4 71.1 53.5 65.9                                                                                
56.9 70.4 78 14.7 73.6 14.4 80 8.3 68.2 1 67.3 17 73.3 22 63 24                                                                                
77.6 22.3 71.9 29.1 64.1 34.7 67.3 32.6 71.7 32.3 77.3 34.2 67.9                                                                               
39.1 76 30.4 75.7 36.6 72.8 48.4 62.4 46.7 60.5 57.9 62.1 51.7                                                                                 
70 45.9 76 53.5 68 57.4 75.1 58.7 79.5 43.5 78.5 80 65.4 69.2                                                                                  
73.2 62.4 61.7 78.9 66.5 86.5 70.6 81.6 92.4 3.8 98.7 12.5 83.6                                                                                
12.3 85.2 18.7 97.3 19 91.9 15 89.4 39 88.6 32.8 81.6 25.5 88.2                                                                                
24 93.6 25 93.4 29.8 83.1 36.3 93.1 35.5 82 39.8 95.2 40.2 84.8                                                                                
48.4 98.1 50.4 97.3 59.7 81.6 59.2 84.2 75.9 80.4 75.35 80.4                                                                                   
88.1 82.4 90.5 84.6 81.4 90.9 86.2 105.5 3.8 101 8.6 103.5 16.6                                                                                
103.7 29.7 101.2 25.8 102.3 35.5 100.8 38.9 103.1 52.9 107.1                                                                                   
74.4 77.5 15.7 73.3 55 75.2 90.7 94.3 22.1 89.7 32.3 87.6 9.2                                                                                  
;;;;                                                                                                                                           
run;quit;                                                                                                                                      
                                                                                                                                               
SD1.HAVE total obs=240                                                                                                                         
                                                                                                                                               
Obs        X       Y                                                                                                                           
                                                                                                                                               
  1     14.4    17.4                                                                                                                           
  2     17.8     7.3                                                                                                                           
  3     17.8    15.8                                                                                                                           
  4      9.4     8.3                                                                                                                           
  5      5.4     2.6                                                                                                                           
  6     14.7     0.9                                                                                                                           
  7      5.8    18.6                                                                                                                           
 ...                                                                                                                                           
                                                                                                                                               
options ps=40 ls=64;                                                                                                                           
proc plot data=sd1.have;                                                                                                                       
plot y*x='*'/ vref=45  href=50 box                                                                                                             
  haxis=-5 to 105 by 15  vaxis=-5 to 105 by 15;                                                                                                
run;quit;                                                                                                                                      
                                                                                                                                               
    -5      10      25      40      55      70      85      100                                                                                
    -+-------+-------+-------+-------+-------+-------+-------+--+                                                                              
  Y |                            50                             |                                                                              
100 +                             |                             + 100                                                                          
    |                             |                             |                                                                              
    |                    * *     *|             *         *     |                                                                              
    |        *                    |     *          **   *       |                                                                              
 85 +                *       *    |*  *  * *            *   *   + 85                                                                           
    |          * *      ** *     *|          *    *  *          |                                                                              
    |    *                        |  *  **           *     *    |                                                                              
    |                 *           |    *  *    * ***        *   |                                                                              
 70 +      *     *        *  *    |*  *    * *                  + 70                                                                           
    |          * *                * *   *     *     *           |                                                                              
    |                *    * *     |          * *   *  *   *     |                                                                              
    |        *    *  *          * |  *  *   *  **  *        *   |                                                                              
 55 +     *                  *  * |        *   **  *   *     *  + 55                                                                           
    |  *           *  *   *       |   *  *        **  *     *   |                                                                              
    |     *                      *|*     *  ***      **       * |                                                                              
    |45--*------------------*-----O-***-*------*-**--*---*--*-45|                                                                              
 40 +               *  *  *  *  * | 55,45   *      *   *  *  *  + 40                                                                           
    |       *    *                | *     * *   * * *    *   ** |                                                                              
    |          *           *     *|    *    * *  **    **       |                                                                              
    |      *  *     *             |           * *        *      |                                                                              
 25 +             *         *  *  |      *      *  * * *  * * * + 25                                                                           
    |                *            |      * *   * *  *  *  *     |                                                                              
    |      *   * *            *   |  *      * *  *  **    * *   |                                                                              
    |                             |*         * * * **   **  *   |                                                                              
 10 +        *               * *  |        *    * *   **      * + 10                                                                           
    |            *    * *       * |             *               |                                                                              
    |      *    *        * * **   |   *     *       *  * *      |                                                                              
    |                             |                             |                                                                              
 -5 +                             |                             + -5                                                                           
    |                             |                             |                                                                              
    -+-------+-------+-------+-------+-------+-------+-------+--+                                                                              
    -5      10      25      40      55      70      85      100                                                                                
                                                                                                                                               
*            _               _                                                                                                                 
  ___  _   _| |_ _ __  _   _| |_                                                                                                               
 / _ \| | | | __| '_ \| | | | __|                                                                                                              
| (_) | |_| | |_| |_) | |_| | |_                                                                                                               
 \___/ \__,_|\__| .__/ \__,_|\__|                                                                                                              
                |_|                                                                                                                            
;                                                                                                                                              
                                                                                                                                               
WORK.STATS total obs=1                                                                                                                         
                                                                                                                                               
Obs    Intensity  (measure of neighborhoodness?)                                                                                               
                                                                                                                                               
 1     0.025083                                                                                                                                
                                                                                                                                               
*_           _     _                                                                                                                           
(_)_ __  ___(_) __| | ___                                                                                                                      
| | '_ \/ __| |/ _` |/ _ \                                                                                                                     
| | | | \__ \ | (_| |  __/                                                                                                                     
|_|_| |_|___/_|\__,_|\___|                                                                                                                     
                                                                                                                                               
;                                                                                                                                              
                               INSIDE                                                                                                          
      -5       -19      -37      55       73       91       109                                                                                
     --+--------+--------+--------+--------+--------+--------+---                                                                              
   Y |                            |                             |                                                                              
 109 +                            |                             +109                                                                           
     |                        **********                        |                                                                              
     |                   ********************                   |                                                                              
  90 +                *****       |        *****                + 90                                                                           
     |             ****   *       |           ****              |                                                                              
     |            *** *           *              ***            |                                                                              
  81 +          ***     *         |                ***          + 81                                                                           
     |         **       *   *    *|*            *   ***         |                                                                              
     |        ** *                |                  ***        |                                                                              
  72 +       **               *   |                    **       + 72                                                                           
     |      **          *         |          *          **      |                                                                              
     |     **      *              *                     **      |                                                                              
  63 +    **                     *|              * *     **     + 63                                                                           
     |    **   *                  |        *             ***    |                                                                              
     |    *                *      |                       **    |                                                                              
  54 +   **               * *     |*                      **    + 54                                                                           
     |   **                       |                     *  *    |                                                                              
     |   **     *                 |    *        *          *    |                                                                              
  45 +---**-*-----------------*---O-----------------*---*--*----+ 45                                                                           
     |   **                       |55,45               *   *    |                                                                              
     |   **            *          |                        *    |                                                                              
  36 +   **   *  *    *       **  | *                     **    + 36                                                                           
     |    *                *      |    *                  **    |                                                                              
     |    **   *   *              |*                      **    |                                                                              
  27 +    **   *                  |                      **     + 27                                                                           
     |     **          *  **   *  |                *    **      |                                                                              
     |      **            *   *   |           *         **      |                                                                              
  18 +       ** *         *       |    *  *            **       + 18                                                                           
     |        **       *  *       |              *   ***        |                                                                              
     |         **   *           * |        *        ***         |                                                                              
   9 +          ***               |                ***          +  9                                                                           
     |            ***             | *    **      ***            |                                                                              
     |             ****   *       |*          ****              |                                                                              
   0 +                ***** *     |*       *****                +  0                                                                           
     |                   ********************                   |                                                                              
     |                        **********                        |                                                                              
  -9 +                            |                             + -9                                                                           
     |                            |                             |                                                                              
     --+--------+--------+--------+--------+--------+--------+---                                                                              
      -5       -19      -37      55       73       91      109                                                                                 
                                                                                                                                               
                                                                                                                                               
 INSIDE POINTS                                                                                                                                 
                                                                                                                                               
WORK.WANTIN total obs=197                                                                                                                      
                                                                                                                                               
Obs    XINSIDE    YINSIDE                                                                                                                      
                                                                                                                                               
  1      14.4       17.4                                                                                                                       
  2      17.8       15.8                                                                                                                       
  3       8.2       36.5                                                                                                                       
  4      11.0       29.8                                                                                                                       
  5      14.6       30.8                                                                                                                       
  6      17.6       36.1                                                                                                                       
....                                                                                                                                           
                                                                                                                                               
*            _       _     _                                                                                                                   
  ___  _   _| |_ ___(_) __| | ___                                                                                                              
 / _ \| | | | __/ __| |/ _` |/ _ \                                                                                                             
| (_) | |_| | |_\__ \ | (_| |  __/                                                                                                             
 \___/ \__,_|\__|___/_|\__,_|\___|                                                                                                             
                                                                                                                                               
;                                                                                                                                              
                                                                                                                                               
                               OUTSIDE                                                                                                         
      -5       -19      -37      55       73       91       109                                                                                
     --+--------+--------+--------+--------+--------+--------+----                                                                             
   Y |                             |                             |                                                                             
 109 +                             |                             +109                                                                          
     |                 *       **********      *   *             |                                                                             
     |     * *      *     ********************      **      *    |                                                                             
  90 +                 *****       |        *****   *       *    + 90                                                                          
     |      *       ****           |           ****              |                                                                             
     |      *      ***             |              ***  *    *    |                                                                             
  81 +       *   ***               |                *** *        + 81                                                                          
     |       *  **                 |                 ***         |                                                                             
     |         **                  |                  ***        |                                                                             
  72 +        **                   |                    **  *    + 72                                                                          
     |       **                    |                     ** *    |                                                                             
     |      **                     |                     **      |                                                                             
  63 +     **                      |                      **     + 63                                                                          
     |     **                      |                       **    |                                                                             
     |     *                       |                       **    |                                                                             
  54 +    **                       |                       **    + 54                                                                          
     |    **                       |                        *    |                                                                             
     |    **                       |                        *    |                                                                             
  45 +----**-----------------------O------------------------*--  + 45                                                                          
     |    **                       | 55,45                  *    |                                                                             
     |    **                       |                        *    |                                                                             
  36 +    **                       |                       **    + 36                                                                          
     |     *                       |                       **    |                                                                             
     |     **                      |                       **    |                                                                             
  27 +     **                      |                      **     + 27                                                                          
     |      **                     |                     **      |                                                                             
     |       **                    |                     **      |                                                                             
  18 +        **                   |                    **       + 18                                                                          
     |         **                  |                  ***        |                                                                             
     |     * *  **                 |                 ***    *    |                                                                             
   9 +       **  ***               |                ***    *     +  9                                                                          
     |             ***             |              ***       *    |                                                                             
     |      * ** *  ****           |           ****   ***  *     |                                                                             
   0 +     *  **   *   *****       |        *****  *   **  **    +  0                                                                          
     |     *              ********************     *** *  ***    |                                                                             
     |                         **********      *                 |                                                                             
  -9 +                             |                             + -9                                                                          
     | |                                                         |                                                                             
     --+--------+--------+--------+--------+--------+--------+----                                                                             
      -5       -19      -37      55       73       91      109                                                                                 
                                                                                                                                               
                                                                                                                                               
WORK.WANTOUT total obs=43                                                                                                                      
                                                                                                                                               
Obs    XOUTSIDE    YOUTSIDE                                                                                                                    
                                                                                                                                               
  1       17.8        7.3                                                                                                                      
  2        9.4        8.3                                                                                                                      
  3        5.4        2.6                                                                                                                      
  4       14.7        0.9                                                                                                                      
  5        5.8       18.6                                                                                                                      
  6        6.6       27.5                                                                                                                      
 ....                                                                                                                                          
                                                                                                                                               
*                                                                                                                                              
 _ __  _ __ ___   ___ ___  ___ ___                                                                                                             
| '_ \| '__/ _ \ / __/ _ \/ __/ __|                                                                                                            
| |_) | | | (_) | (_|  __/\__ \__ \                                                                                                            
| .__/|_|  \___/ \___\___||___/___/                                                                                                            
|_|                                                                                                                                            
;                                                                                                                                              
                                                                                                                                               
%let x_origin=55;                                                                                                                              
%let y_origin=45;                                                                                                                              
%let radius=50;                                                                                                                                
                                                                                                                                               
%utlfkil(d:/xpt/want.xpt);                                                                                                                     
proc datsets lib=work kill;                                                                                                                    
run;quit;                                                                                                                                      
                                                                                                                                               
%utl_submit_r64("                                                                                                                              
 library(ads);                                                                                                                                 
 library(SASxport);                                                                                                                            
 library(data.table);                                                                                                                          
 library(haven);                                                                                                                               
 have<-read_sas('d:/sd1/have.sas7bdat');                                                                                                       
 data(BPoirier);                                                                                                                               
 BP <- BPoirier;                                                                                                                               
 swc <- spp(have, win=c(&x_origin,&y_origin,&radius));                                                                                         
 wantout<-as.data.table(cbind(swc$xout,swc$yout));                                                                                             
 wantin<-as.data.table(cbind(swc$x,swc$y));                                                                                                    
 colnames(wantin)<-c('XINSIDE','YINSIDE');                                                                                                     
 colnames(wantout)<-c('XOUTSIDE','YOUTSIDE');                                                                                                  
 smry<-summary(swc);                                                                                                                           
 stats<-as.data.table(smry$intensity);                                                                                                         
 colnames(stats)<-'INTENSITY';                                                                                                                 
 pdf('d:/pdf/circle.pdf');                                                                                                                     
 plot(swc);                                                                                                                                    
 plot(swc, out=TRUE);                                                                                                                          
 pdf();                                                                                                                                        
 write.xport(wantin,wantout,stats,file='d:/xpt/want.xpt');                                                                                     
");                                                                                                                                            
                                                                                                                                               
libname xpt xport "d:/xpt/want.xpt";                                                                                                           
data wantin;  set xpt.wantin;  run;quit;                                                                                                       
data wantout; set xpt.wantout; run;quit;                                                                                                       
data stats;   set xpt.stats;   run;quit;                                                                                                       
libname xpt clear;                                                                                                                             
                                                                                                                                               
                                                                                                                                               
1504  libname xpt xport "d:/xpt/want.xpt";                                                                                                     
NOTE: Libref XPT was successfully assigned as follows:                                                                                         
      Engine:        XPORT                                                                                                                     
      Physical Name: d:\xpt\want.xpt                                                                                                           
1505  data wantin;  set xpt.wantin;  run;quit;                                                                                                 
NOTE: There were 197 observations read from the data set                                                                                       
      XPT.WANTIN.                                                                                                                              
NOTE: The data set WORK.WANTIN has 197 observations and 2                                                                                      
      variables.                                                                                                                               
NOTE: DATA statement used (Total process time):                                                                                                
      real time           0.01 seconds                                                                                                         
      cpu time            0.00 seconds                                                                                                         
                                                                                                                                               
                                                                                                                                               
1506  data wantout; set xpt.wantout; run;                                                                                                      
                                                                                                                                               
NOTE: There were 43 observations read from the data set                                                                                        
      XPT.WANTOUT.                                                                                                                             
NOTE: The data set WORK.WANTOUT has 43 observations and 2                                                                                      
      variables.                                                                                                                               
NOTE: DATA statement used (Total process time):                                                                                                
      real time           0.01 seconds                                                                                                         
      cpu time            0.00 seconds                                                                                                         
                                                                                                                                               
                                                                                                                                               
1506!                                    quit;                                                                                                 
1507  data stats;   set xpt.stats;   run;                                                                                                      
                                                                                                                                               
NOTE: There were 1 observations read from the data set                                                                                         
      XPT.STATS.                                                                                                                               
NOTE: The data set WORK.STATS has 1 observations and 1                                                                                         
      variables.                                                                                                                               
NOTE: DATA statement used (Total process time):                                                                                                
      real time           0.01 seconds                                                                                                         
      cpu time            0.01 seconds                                                                                                         
                                                                                                                                               
